<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Admin Panel</title>
    <link rel="stylesheet" href="/static/style.css" id="theme-link">
    <link href="https://fonts.googleapis.com/icon?family=Material+Icons" rel="stylesheet">
</head>
<body>
    <nav>
        <ul>
            <li><a href="/"><span class="material-icons">home</span> Home</a></li>
            <li><a href="/auth/admin"><span class="material-icons">admin_panel_settings</span> Admin</a></li>
            <li><a href="/auth/logout"><span class="material-icons">logout</span> Logout</a></li>
        </ul>
    </nav>

    <div class="main-content container fantasy-theme">
        <h1>Admin Panel</h1>
        <ul>
            <li><a href="{{ url_for('admin.list_questions') }}">List Questions</a></li>
            <li><a href="{{ url_for('admin.add_question') }}">Add Question</a></li>
        </ul>
        <form action="{{ url_for('admin.upload_geojson') }}" method="POST" enctype="multipart/form-data">
            <label for="geojson_file">Upload GeoJSON File:</label>
            <input type="file" id="geojson_file" name="geojson_file">
            <button type="submit">Upload</button>
        </form>
        <h2>Manage Layers</h2>
        {% for room in rooms %}
        <h3>Room {{ room.id }}</h3>
        <table>
            <tr>
                <th>Layer Name</th>
                <th>Actions</th>
            </tr>
            {% for layer in geojson_layers %}
            <tr>
                <td>{{ layer.name }}</td>
                <td>
                    <form action="{{ url_for('admin.toggle_layer', layer_id=layer.id, room_id=room.id) }}" method="POST" style="display:inline;">
                        <button type="submit">{{ "Deactivate" if layer in room.active_layers else "Activate" }}</button>
                    </form>
                    <form action="{{ url_for('admin.delete_layer', layer_id=layer.id) }}" method="POST" style="display:inline;">
                        <button type="submit">Delete</button>
                    </form>
                </td>
            </tr>
            {% endfor %}
        </table>
        {% endfor %}
    </div>

    <script>
        function toggleDarkMode() {
            const themeLink = document.getElementById('theme-link');
            if (themeLink.getAttribute('href') === '/static/style.css') {
                themeLink.setAttribute('href', '/static/dark-mode.css');
            } else {
                themeLink.setAttribute('href', '/static/style.css');
            }
        }
    </script>
</body>
</html>
