<!-- templates/room.html -->
<script>
    const socket = io();
    const room = "{{ room_id }}";
    
    // Get the username from the profile page
    const usernameInput = document.querySelector('#name');
    const username = usernameInput ? usernameInput.value : null;

    if (username) {
        socket.emit('join', { room, username });

        socket.on('player_joined', (data) => {
            const playersDiv = document.getElementById('players');
            playersDiv.innerHTML += `<p>${data.username} joined the room.</p>`;
        });

        socket.on('new_question', (data) => {
            document.getElementById('question').innerText = data.question;
        });

        socket.on('update_scores', (scores) => {
            const scoresDiv = document.getElementById('scores');
            scoresDiv.innerHTML = '';
            for (const [player, score] of Object.entries(scores)) {
                scoresDiv.innerHTML += `<p>${player}: ${score}</p>`;
            }
        });

        socket.on('game_over', () => {
            alert('Game over!');
        });

        function submitAnswer() {
            const answer = document.getElementById('answer').value;
            socket.emit('answer', { room, username, answer });
            document.getElementById('answer').value = '';
        }
    } else {
        console.error('Username input field not found or empty.');
    }
</script>
